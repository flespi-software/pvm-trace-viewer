(this["webpackJsonppvm-trace-viewer"]=this["webpackJsonppvm-trace-viewer"]||[]).push([[0],[,,,,,,,,,,,,function(e,t,c){},,,function(e,t,c){},function(e,t,c){},function(e,t,c){},function(e,t,c){},function(e,t,c){},function(e,t,c){},function(e,t,c){},function(e,t,c){},function(e,t,c){"use strict";c.r(t);var n,r=c(1),a=c.n(r),s=c(6),i=c.n(s),l=(c(12),c(3)),o=c(2),d=c.n(o),u=c(7),j=c(0),p=function(e){e&&e.scrollIntoView({behavior:"auto",block:"center",inline:"center"})},f=function(e,t,c){if(!e.sourceLines)return"?";var n=function(e,t){var c=e.files.find((function(e){return e[0]===t}));if(!c)return null;var n=c[1];return n===e.bytecode_name?"main":n}(e,t);return n?e.sourceLines[n][c-1].trim():"?"},x=function(e){for(var t=[],c=0;c<e.length;){var n=e.slice(c,c+2);t.push(Number.parseInt(n,16)),c+=2}return t.map((function(e){if(9===e)return Object(j.jsx)("span",{className:"special-data-char",children:"\\t"});if(10===e)return Object(j.jsx)("span",{className:"special-data-char",children:"\\n"});if(13===e)return Object(j.jsx)("span",{className:"special-data-char",children:"\\r"});if(e<32){var t=e.toString(16).toUpperCase();return t.length<2&&(t="0".concat(t)),Object(j.jsxs)("span",{className:"special-data-char",children:["\\x",t]})}return String.fromCharCode(e)}))};!function(e){e.Line="l",e.NewData="n",e.Offset="o",e.Error="e"}(n||(n={}));var h=function(e){return e.d.length/2},b=(c(15),function(e){var t,c=e.traceDump,n=e.stepIndex,r=c.trace[n],a=null===(t=c.sourceLines)||void 0===t?void 0:t.main;if(!a)return Object(j.jsx)("div",{children:"no source code available"});var s=a.map((function(e,t){var c;return c=""===e?Object(j.jsx)("br",{}):e,Object(j.jsx)("pre",{ref:t===r.c[1]-1?p:void 0,className:t===r.c[1]-1?"source-code-line source-code-line-selected":"source-code-line",children:c},t)}));return Object(j.jsx)("div",{className:"source-code-lines",children:s})}),v=function(e){var t=e.value,c=new Date(1e3*t).toLocaleString("en-GB",{hour:"numeric",minute:"numeric",second:"numeric"}),n=Number(t).toFixed(6).split(".")[1];return Object(j.jsxs)("span",{children:[c,".",n]})},m=(c(16),function(e){var t,c,r=e.traceDump,a=e.stepIndex,s=e.index,i=e.packetStep,l=e.setStepIndex,o=e.step,d=e.decodeHex,u=r.variables,b=function(e){var t=u.find((function(t){return t[0]===e}));return t?t[1]:"?"};switch(o.t){case n.Line:t=Object(j.jsxs)("div",{children:[Object(j.jsx)("div",{children:(c=o.v,c.map((function(e,t){return"number"===typeof e?Object(j.jsxs)("span",{className:"trace-var",children:["UNSET $",b(e)]},t):Object(j.jsxs)("span",{className:"trace-var",children:["$",b(e[0])," = ",e[2]]},t)})))}),Object(j.jsx)("div",{className:"trace-step-source-line",children:f(r,o.c[0],o.c[1])})]});break;case n.NewData:var m=h(o);t=Object(j.jsxs)("div",{children:[Object(j.jsxs)("div",{className:"trace-step-data",children:[Object(j.jsx)("span",{className:"trace-step-data-column trace-step-data-column-value",children:d?x(o.d):o.d}),Object(j.jsx)("span",{className:"trace-step-data-column",children:Object(j.jsxs)("small",{children:[m," bytes,\xa0",Object(j.jsx)(v,{value:o.tm})]})})]}),Object(j.jsx)("div",{className:"trace-step-source-line",children:f(r,o.c[0],o.c[1])})]});break;case n.Offset:t=Object(j.jsxs)("div",{children:[Object(j.jsxs)("div",{className:"trace-step-data",children:[Object(j.jsx)("span",{className:"trace-step-data-column trace-step-data-column-value",children:i&&Object(j.jsxs)(j.Fragment,{children:["\xa0\xa0",d?x(i.d.slice(2*o.l,2*o.o)):i.d.slice(2*o.l,2*o.o)]})}),Object(j.jsx)("span",{className:"trace-step-data-column",children:Object(j.jsxs)("small",{children:[o.o-o.l," bytes: ",o.l,"...",o.o]})})]}),Object(j.jsx)("div",{className:"trace-step-source-line",children:f(r,o.c[0],o.c[1])})]});break;case n.Error:t=Object(j.jsxs)("div",{children:["Error:",Object(j.jsx)("pre",{className:"trace-step-error",children:o.m}),Object(j.jsx)("div",{className:"trace-step-source-line",children:f(r,o.c[0],o.c[1])})]})}return Object(j.jsx)("div",{ref:s===a?p:void 0,className:s===a?"trace-step trace-step-selected":"trace-step",onClick:function(){return function(e){l(e)}(s)},children:t},s)}),O=(c(17),function(e){var t,c=e.traceDump.trace,r=e.stepIndex,a=e.setStepIndex,s=e.showAllSteps,i=e.decodeHex,l=c[r];console.log("step",l);var o=[];return c.forEach((function(c,l){c.t===n.NewData&&(t=c),(s||c.t!==n.Line)&&o.push(Object(j.jsx)(m,{traceDump:e.traceDump,stepIndex:r,index:l,packetStep:t,setStepIndex:a,step:c,decodeHex:i},l))})),Object(j.jsx)("div",{className:"trace-dump-steps",children:o})}),N=(c(18),function(e){var t=e.packet,c=e.step,n=e.index,r=e.stepIndex,a=e.setStepIndex,s=e.decodeHex,i=t.d.slice(2*c.l,2*c.o);return Object(j.jsx)("span",{ref:n===r?p:void 0,className:n===r?"trace-packet-part trace-packet-part-selected":"trace-packet-part",onClick:function(){return function(e){a(e)}(n)},children:s?x(i):i})}),g=(c(19),function(e,t){return Object(o.findLastIndex)(e,(function(e){return e.t===n.NewData}),t-1)}),k=function(e,t){return Object(o.findIndex)(e,(function(e){return e.t===n.NewData}),t+1)},I=function(e){var t=e.traceDump.trace,c=e.packetIndex,r=e.setPacketIndex,a=e.stepIndex,s=e.setStepIndex,i=e.decodeHex,l=t[c];if(!l){var o=k(t,-1);return-1===o?Object(j.jsx)("div",{children:"No data packets available in the trace file"}):(setTimeout((function(){return r(o)})),null)}for(var d=[],u=c+1,p=t[u];p&&p.t!==n.NewData;)p.t===n.Offset&&d.push(Object(j.jsx)(N,{packet:l,step:p,index:u,stepIndex:a,setStepIndex:s,decodeHex:i},u)),p=t[u+=1];return Object(j.jsxs)("div",{className:"trace-packet",children:[Object(j.jsxs)("div",{className:"trace-packet-info",children:[Object(j.jsx)("div",{className:"flex",children:Object(j.jsx)("button",{onClick:function(){var e=g(t,c);-1===e&&(e=g(t,t.length)),r(e)},children:"<"})}),Object(j.jsx)("div",{className:"flex",children:Object(j.jsx)("button",{onClick:function(){var e=k(t,c);-1===e&&(e=k(t,-1)),r(e)},children:">"})}),Object(j.jsxs)("div",{className:"flex trace-packet-pad",children:["Time:\xa0",Object(j.jsx)(v,{value:l.tm})]}),Object(j.jsxs)("div",{className:"flex trace-packet-pad",children:["Size: ",h(l)," B"]})]}),Object(j.jsx)("div",{className:"flex trace-packet-hex",children:d})]})},S=(c(20),function(e){var t=e.traceFile,c=e.traceDump,a=Object(r.useState)(-1),s=Object(l.a)(a,2),i=s[0],o=s[1],p=Object(r.useState)(0),x=Object(l.a)(p,2),v=x[0],m=x[1],N=Object(r.useState)(!1),g=Object(l.a)(N,2),k=g[0],S=g[1],w=Object(r.useState)(!1),D=Object(l.a)(w,2),L=D[0],C=D[1],F=function(e){e<0?e=c.trace.length-1:e>=c.trace.length&&(e=0),m(e);var t=d.a.findLastIndex(c.trace,(function(e){return e.t===n.NewData}),e);-1!==t&&o(t)},T=function(e,c){var n=document.createElement("a");n.download=t.name+c,n.href=URL.createObjectURL(new Blob([e],{type:"text/plain"})),n.click()};return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsxs)("div",{className:"trace-file-info",children:["Loaded trace dump file ",Object(j.jsx)("strong",{children:t.name})," of size ",Object(j.jsx)("strong",{children:Number(t.size/1024).toFixed(2)})," KiB"]}),Object(j.jsx)(I,{traceDump:c,packetIndex:i,setPacketIndex:function(e){o(e),m(e)},stepIndex:v,setStepIndex:F,decodeHex:L}),Object(j.jsxs)("div",{className:"trace-view-settings",children:[Object(j.jsx)("button",{onClick:function(){return F(function(e){if(k)return e-1;var t=d.a.findLastIndex(c.trace,(function(e){return e.t!==n.Line}),e-1);return-1===t&&(t=d.a.findLastIndex(c.trace,(function(e){return e.t!==n.Line}),c.trace.length-1)),t}(v))},children:"<"}),Object(j.jsx)("button",{onClick:function(){return F(function(e){if(k)return e+1;var t=d.a.findIndex(c.trace,(function(e){return e.t!==n.Line}),e+1);return-1===t&&(t=d.a.findIndex(c.trace,(function(e){return e.t!==n.Line}),0)),t}(v))},children:">"}),"\xa0",Object(j.jsxs)("label",{children:[Object(j.jsx)("input",{type:"checkbox",onChange:function(e){S(e.target.checked)}})," show all steps"]}),"\xa0|\xa0",Object(j.jsxs)("label",{children:[Object(j.jsx)("input",{type:"checkbox",onChange:function(e){C(e.target.checked)}})," decode hex"]}),"\xa0",Object(j.jsx)("button",{onClick:function(){var e,t=[["type","size","hex","code"]];c.trace.forEach((function(r){if(r.t!==n.Line){var a=[r.t];if(r.t===n.NewData)e=r,a.push(h(r).toString()),a.push(r.d);else if(r.t===n.Offset){var s=e.d.slice(2*r.l,2*r.o);a.push((r.o-r.l).toString()),a.push(s)}else r.t===n.Error&&(a.push(""),a.push(r.m));a.push(f(c,r.c[0],r.c[1])),t.push(a)}}));var r=new u.Parser({header:!1,eol:"\n",delimiter:";"}).parse(t);T(r,".export.csv")},children:"Export to CSV"}),"\xa0",Object(j.jsx)("button",{onClick:function(){for(var e=[],t=null,r=0,a=0;a<c.trace.length;a++){var s=c.trace[a];if(s.t===n.NewData){t=s,r=0,e.length>0&&e.push(""),e.push("New packet of ".concat(h(s)," bytes:")),e.push("\t".concat(s.d)),e.push("");for(var i=a+1;i<c.trace.length;i++){var l=c.trace[i];if(l.t===n.Offset){var o=2*(l.o-l.l);o>r&&(r=o)}else if(l.t===n.NewData)break}}else if(s.t===n.Offset){if(t){var d=t.d.slice(2*s.l,2*s.o),u=r-d.length;e.push("".concat(d).concat(" ".repeat(u),"\t\t").concat(f(c,s.c[0],s.c[1])))}}else s.t===n.Error&&(e.push(""),e.push(s.m))}T(e.join("\n"),".export.txt")},children:"Export to TXT"})]}),Object(j.jsxs)("div",{className:"trace-dump-details",children:[Object(j.jsx)(O,{traceDump:c,stepIndex:v,setStepIndex:F,showAllSteps:k,decodeHex:L}),Object(j.jsx)(b,{traceDump:c,stepIndex:v})]})]})}),w=(c(21),function(e){return Object(j.jsxs)("header",{className:"trace-dump-header",children:["Load trace dump:",Object(j.jsx)("input",{type:"file",onChange:function(t){if(t.target.files){var c=new FileReader,n=t.target.files[0];c.readAsText(n,"UTF-8"),e.setTraceFile({name:n.name,size:n.size}),c.onload=function(t){var c;if(null===(c=t.target)||void 0===c?void 0:c.result){var n=t.target.result.toString(),r=JSON.parse(n);if(r.source){r.sourceLines={};for(var a=0,s=Object.keys(r.source);a<s.length;a++){var i=s[a],l=r.source[i].split("\n");r.sourceLines[i]=l}}e.setTraceDump(r)}}}}})]})});c(22);var D=function(){var e=Object(r.useState)(),t=Object(l.a)(e,2),c=t[0],n=t[1],a=Object(r.useState)(),s=Object(l.a)(a,2),i=s[0],o=s[1];return console.log("traceFile, traceDump",c,i),Object(j.jsx)("div",{className:"App",children:i&&c?Object(j.jsx)(S,{traceFile:c,traceDump:i}):Object(j.jsx)(w,{setTraceFile:n,setTraceDump:o})})},L=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,24)).then((function(t){var c=t.getCLS,n=t.getFID,r=t.getFCP,a=t.getLCP,s=t.getTTFB;c(e),n(e),r(e),a(e),s(e)}))};i.a.render(Object(j.jsx)(a.a.StrictMode,{children:Object(j.jsx)(D,{})}),document.getElementById("root")),L()}],[[23,1,2]]]);
//# sourceMappingURL=main.c7ba6881.chunk.js.map